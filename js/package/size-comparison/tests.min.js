import{simd as _}from"wasm-feature-detect";function a(t,o,r){return new Float64Array(r.buffer,t,o)}function c(t,o){if(t instanceof Float64Array)o.set(t);else if(t instanceof Array)o.set(t);else{let r=t.length;if(r>0&&typeof t[0]=="number")try{o.set(t)}catch{for(let e=0;e<r;e++)o[e]=t[e]}else for(let e=0;e<t.length;e++)o[e]=t[e]}}function u(t,o){let r=a(t.ptr,t.len,o),e=new Float64Array(t.len);return e.set(r),e}async function m(t){let o=await _();return await import(t)}var n=null;async function h(){if(n)return;n=await m("../../../crates/stat-wasm-tests/pkg/stat_wasm_tests.js")}function g(t,o){if(!n)throw new Error("Wasm module not initialized. Call init() first.");let r=t.length;if(r===0)return{statistic:NaN,p_value:NaN,df:null};let e=n.alloc_f64(r),i=a(e,r,n.get_memory());c(t,i);let s=n.ttest_f64(e,r,o);return n.free_f64(e,r),{statistic:s.statistic,p_value:s.p_value,df:s.df}}function N(t,o,r){if(!n)throw new Error("Wasm module not initialized. Call init() first.");let e=t.length;if(e===0)return{statistic:NaN,p_value:NaN,df:null};let i=n.alloc_f64(e),s=a(i,e,n.get_memory());c(t,s);let f=n.ztest_f64(i,e,o,r);return n.free_f64(i,e),{statistic:f.statistic,p_value:f.p_value,df:f.df}}function W(t,o){if(!n)throw new Error("Wasm module not initialized. Call init() first.");if(t.length!==o.length)throw new Error("x and y arrays must have the same length");let r=t.length;if(r===0)return{slope:NaN,intercept:NaN,r_squared:NaN,residuals:new Float64Array};let e=n.alloc_f64(r),i=n.alloc_f64(r),s=a(e,r,n.get_memory()),f=a(i,r,n.get_memory());c(t,s),c(o,f);let l=n.regress_f64(e,r,i,r),p=u(l.residuals,n.get_memory());return n.free_f64(e,r),n.free_f64(i,r),n.free_f64(l.residuals.ptr,l.residuals.len),{slope:l.slope,intercept:l.intercept,r_squared:l.r_squared,residuals:p}}function x(t,o,r){if(!n)throw new Error("Wasm module not initialized. Call init() first.");let e=n.normalci_f64(t,o,r);return[e[0],e[1]]}function A(t,o,r,e){if(!n)throw new Error("Wasm module not initialized. Call init() first.");let i=n.tci_f64(t,o,r,e);return[i[0],i[1]]}export{h as init,x as normalci,W as regress,A as tci,g as ttest,N as ztest};
